<div
    data-service="database.getCollection"
    data-param-collection-id="{{router.params.collection}}"
    data-scope="sdk"
    data-event="load,database.updateCollection"
    data-name="project-collection">
    
    <div
        data-service="database.getDocument"
        data-param-collection-id="{{router.params.collection}}"
        data-param-document-id="{{router.params.id}}"
        data-scope="sdk"
        data-event="load,database.updateDocument"
        data-name="project-document"
        data-success="default">

        <div class="cover">
            <h1 class="zone xl margin-bottom-large">
                <a data-ls-attrs="href=/console/database/collection?id={{router.params.collection}}&project={{router.params.project}}" class="back text-size-small link-return-animation--start"><i class="icon-left-open"></i> <span data-ls-bind="{{project-collection.name}}"></span></a>

                <br />

                <span data-ls-if="({{project-document.$id}})" data-ls-bind="Document">&nbsp;&nbsp;</span>
                <span data-ls-if="(!{{project-document.$id}})" data-ls-bind="Document">&nbsp;&nbsp;</span>
            </h1>
        </div>

        <div data-ui-modal class="modal width-large box close" data-button-hide="on" data-open-event="open-json">
            <button type="button" class="close pull-end" data-ui-modal-close=""><i class="icon-cancel"></i></button>    
            
            <h2>JSON View</h2>

            <div class="margin-bottom">
                <input type="hidden" data-ls-bind="{{project-document}}" data-forms-code />
            </div>

            <button data-ui-modal-close="" type="button" class="reverse">Cancel</button>
        </div>

        <div class="zone xl margin-bottom-no">
            <ul class="phases clear" data-ui-phases data-selected="{{router.params.tab}}">
                <li data-state="/console/database/document?id={{router.params.id}}&collection={{router.params.collection}}&project={{router.params.project}}">
                    <h2>Update</h2>

                    <div class="row responsive margin-top-negative">
                        <div class="col span-8 margin-bottom">
                            <form
                                data-analytics
                                data-analytics-activity
                                data-analytics-event="submit"
                                data-analytics-category="console"
                                data-analytics-label="Update Database Document"
                                data-service="{{|documentAction}}"
                                data-name="project-document"
                                data-scope="sdk"
                                data-event="submit"
                                data-success="alert,trigger{{|documentSuccess}}"
                                data-success-param-alert-text="Updated document successfully"
                                data-success-param-trigger-events="database.updateDocument"
                                data-success-param-redirect-url="/console/database/document?id={{serviceData.$id}}&collection={{router.params.collection}}&project={{router.params.project}}"
                                data-failure="alert"
                                data-failure-param-alert-text="Failed to update document"
                                data-failure-param-alert-classname="error">

                                <label>&nbsp;</label>

                                <div class="box">
                                    <div class="toggle margin-bottom" data-ls-ui-open data-button-aria="Open Permissions">
                                        <i class="icon-plus pull-end margin-top-tiny"></i>
                                        <i class="icon-minus pull-end margin-top-tiny"></i>
                                        
                                        <h3 class="margin-bottom-large">Permissions</h3>
                                        
                                        <label for="collection-read">Read Access <span class="text-size-small">(<a data-ls-attrs="href={{env.HOME}}/docs/permissions" target="_blank" rel="noopener">Learn more</a>)</span></label>
                                        <input type="hidden" id="collection-read" name="read" data-forms-tags data-cast-to="json" data-ls-bind="{{project-document.$permissions.read}}" placeholder="User ID, Team ID or Role" />
                                        <div class="text-fade text-size-xs margin-top-negative-small margin-bottom">Add * for wildcard access</div>

                                        <label for="collection-write">Write Access <span class="text-size-small">(<a data-ls-attrs="href={{env.HOME}}/docs/permissions" target="_blank" rel="noopener">Learn more</a>)</label>
                                        <input type="hidden" id="collection-write" name="write" data-forms-tags data-cast-to="json" data-ls-bind="{{project-document.$permissions.write}}" placeholder="User ID, Team ID or Role" />
                                        <div class="text-fade text-size-xs margin-top-negative-small margin-bottom">Add * for wildcard access</div>
                                    </div>

                                    <button data-ls-if="({{project-document.$id}})">Update</button>
                                    <button data-ls-if="(!{{project-document.$id}})">Create</button>
                                </div>

                            </form>
                        </div>
                        <div class="col span-4 sticky-top">

                            <div data-ls-if="({{project-document.$id}})">
                                <label>Document ID</label>
                                <div class="input-copy margin-bottom">
                                    <input type="text" autocomplete="off" placeholder="" data-ls-bind="{{project-document.$id}}" disabled data-forms-copy class="margin-bottom-no" />
                                </div>
                            </div>

                            <label>Collection ID</label>
                            <div class="input-copy margin-bottom">
                                <input type="text" autocomplete="off" placeholder="" data-ls-bind="{{router.params.collection}}" disabled data-forms-copy class="margin-bottom-no" />
                            </div>

                            <ul class="margin-bottom-large text-fade text-size-small" data-ls-if="({{project-document.$id}})">
                                <li class="margin-bottom-small"><i class="icon-angle-circled-right margin-start-tiny margin-end-tiny"></i> <button data-ls-ui-trigger="open-json" class="link text-size-small">View as JSON</button></li>
                            </ul>

                            <div data-ls-if="({{project-document.$id}})">
                                <form name="database.deleteDocument" class="margin-bottom"
                                    data-analytics
                                    data-analytics-activity
                                    data-analytics-event="submit"
                                    data-analytics-category="console"
                                    data-analytics-label="Delete Collection Document"
                                    data-service="database.deleteDocument"
                                    data-event="submit"
                                    data-param-collection-id="{{router.params.collection}}"
                                    data-param-document-id="{{project-document.$id}}"
                                    data-confirm="Are you sure you want to delete this document?"
                                    data-success="alert,trigger,redirect"
                                    data-success-param-alert-text="Document deleted successfully"
                                    data-success-param-trigger-events="database.deleteDocument"
                                    data-success-param-redirect-url="/console/database/collection?id={{router.params.collection}}&project={{router.params.project}}"
                                    data-failure="alert"
                                    data-failure-param-alert-text="Failed to delete collection"
                                    data-failure-param-alert-classname="error">

                                    <button type="submit" class="danger fill">Delete Document</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </li>
                <!-- <li data-ls-if="{{project-document.$id}}" data-state="/console/database/document/activity?id={{router.params.id}}&collection={{router.params.collection}}&project={{router.params.project}}">
                    <h2>Activity</h2>
                </li> -->
            </ul>
        </div>
    </div>
</div>